extends ./_layout

block main
  form( method= "POST" action= "/form", enctype= "multipart/form-data" )
    if data && data.__uuid
      input( type= "hidden", name= "__uuid", value= data.__uuid )

    div.box
      h3 Bestelldaten
      div.box-row
        input(
          type= "text", name= "orderNumber", required,
          placeholder= "Bestellnummer",
          value= data && data.orderNumber
        )
        input(
          type= "text", name= "recordNumber", required,
          placeholder= "Verkaufsprotokoll",
          value= data && data.recordNumber
        )
        input(
          type= "date", name= "orderDate", required,
          value= data && data.orderDate
        )

    div.column
      div.box
        h3 Rechnung (PDF)
        if data && data.invoicePDF
          span (Datei wurde bereit hochgeladen)
        else
          input( type= "file", name= "invoicePDF", accept= ".pdf" )

      div.box
        h3 Versand
        div.box-col
          - var orderType = data && data.orderType
          select( name= "orderType", required )
            option( value= "shipping", selected= ( orderType == 'shipping' ) ) Versand
            option( value= "pickup", selected= ( orderType == 'pickup' ) ) Abholung
          input(
            type= "number", name= "shipping", required,
            placeholder= "Versandkosten / Abholgebühr [€]", min= 0, step= 0.01,
            value= data && data.shipping
          )

      div.box
        h3 Umsatz &amp; Gebühren
        div.box-col
          input(
            type= "number", name= "revenue", required,
            placeholder= "Umsatz / Gesamtbetrag inkl. Versand [€]", min= 0, step= 0.01,
            value= data && data.revenue
          )
          input(
            type= "number", name= "fees", required,
            placeholder= "Gebühren (Werbekosten) [€]", min= 0, step= 0.01,
            value= data && data.fees
          )
          input(
            type= "number", name= "refund",
            placeholder= "Rückerstattung [€]", min= 0, step= 0.01,
            value= data && data.refund
          )
          input(
            type= "number", name= "profit", required,
            placeholder= "Bestelleinnahmen [€]", min= 0, step= 0.01,
            value= data && data.profit
          )

      div.box
        h3 Kundendaten
        div.box-col
          - var customer = data?.customer || {}
          - var address = customer?.address || {}
          input(
            type= "text", name= "customer.nick", required,
            placeholder= "Benutzername",
            value= customer.nick || ''
          )
          input(
            type= "text", name= "customer.name", required,
            placeholder= "Name (Realname)",
            value= customer.name || ''
          )
          input(
            type= "tel", name= "customer.tel",
            placeholder= "Telefonnummer",
            value= customer.tel || ''
          )
          input(
            type= "email", name= "customer.mail", required,
            placeholder= "E-Mail-Adresse",
            value= customer.mail || ''
          )
          h4 Lieferanschrift (bei Versand)
          input(
            type= "text", name= "customer.address.street",
            placeholder= "Straße + Hausnr.",
            value= address.street || ''
          )
          div.box-row
            input(
              type= "text", name= "customer.address.zipCode",
              placeholder= "PLZ",
              value= address.zipCode || ''
            )
            input(
              type= "text", name= "customer.address.city",
              placeholder= "Ort",
              value= address.city || ''
            )
          - var country = address.country || 'de'
          select( name= "customer.address.country", required )
            option( value= "de", selected= ( country == 'de' ) ) Deutschland

    div.box
      h3 Artikel
      div.box-col
        each val in [ 0, 1, 2, 3, 4, 5, 6, 7 ]
          div.box-col
            div.box-row
              - var article = data?.article?.[ val ] || {}
              input(
                type= "text", name= `article.number[${val}]`,
                placeholder= "Artikelnr.",
                value= article.number || ''
              )
              input(
                type= "text", name= `article.name[${val}]`,
                placeholder= "Name",
                value= article.name || ''
              )
              input(
                type= "number", name= `article.quantity[${val}]`,
                placeholder= "Menge", min= 1, max= 99, step= 1,
                value= article.quantity || ''
              )
              input(
                type= "number", name= `article.price[${val}]`,
                placeholder= "Artikelpreis [€]", min= 0, step= 0.01,
                value= article.price || ''
              )
              input(
                type= "number", name= `article.fee[${val}]`,
                placeholder= "Gebühren [€]", min= 0, step= 0.01,
                value= article.fee || ''
              )

    div.box-row
      button( type= "submit" ) Speichern
      button( onclick= "location.href='/orders'", class= "alert" ) Abbrechen
