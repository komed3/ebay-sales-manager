function renderReportChart(t,e){e=Object.fromEntries(Object.entries(e).reverse().slice(0,24).reverse());const o=[],r=[],a=[],n=[],d=[],l=[];for(const[t,i]of Object.entries(e))o.push(t.replaceAll("-","/")),r.push(i.totalShipping),a.push(i.totalFees),n.push(i.totalRefund),d.push(i.totalProfit),l.push(i.profitMargin);new Chart(t,{type:"bar",data:{labels:o,datasets:[{data:l,type:"line",yAxisID:"y2",label:"Gewinnmarge",pointRadius:6,pointHoverRadius:6,tension:.3,backgroundColor:"#fff",hoverBackgroundColor:"#fff",borderColor:"#000",borderWidth:2,hoverBorderWidth:2,clip:!1},{data:r,stack:"finances",label:"Versandkosten",backgroundColor:"#ffbb00",hoverBackgroundColor:"#ffbb00",borderWidth:0},{data:a,stack:"finances",label:"Gebühren",backgroundColor:"#fb6542",hoverBackgroundColor:"#fb6542",borderWidth:0},{data:n,stack:"finances",label:"Erstattungen",backgroundColor:"#698bbe",hoverBackgroundColor:"#698bbe",borderWidth:0},{data:d,stack:"finances",label:"Gewinn",backgroundColor:"#78ac4c",hoverBackgroundColor:"#78ac4c",borderWidth:0}]},options:{interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{font:{size:15},boxWidth:24}},tooltip:{callbacks:{label:t=>`${t.dataset.label}: ${0==t.datasetIndex?formatPercent(t.raw/100):formatMoney(t.raw)}`}}},scales:{x:{stacked:!0,grid:{display:!1},border:{color:"#d5d6d7"}},y:{stacked:!0,beginAtZero:!0,ticks:{maxTicksLimit:8,callback:t=>formatMoney(t,0)},grid:{color:"#d5d6d7"},border:{dash:[5,5],color:"#d5d6d7"}},y2:{position:"right",min:0,max:100,ticks:{maxTicksLimit:6,callback:t=>formatPercent(t/100,0)},grid:{drawOnChartArea:!1,color:"#d5d6d7"},border:{color:"#d5d6d7"}}}}})}function renderMarginChart(t,e){new Chart(t,{type:"doughnut",data:{datasets:[{data:[{x:"Umsatz d. Versand",value:e.shippingRevenue},{x:"Umsatz d. Abholung",value:e.pickupRevenue}],backgroundColor:["#2f88ff","#1060d6"],hoverBackgroundColor:["#2f88ff","#1060d6"],borderColor:"#fff",hoverBorderColor:"#fff",borderWidth:3,borderRadius:12},{data:[{x:"Gewinn",value:e.totalProfit},{x:"Versandkosten",value:e.totalShipping},{x:"Gebühren",value:e.totalFees},{x:"Rückerstattung",value:e.totalRefund}],backgroundColor:["#78ac4c","#ffbb00","#fb6542","#698bbe"],hoverBackgroundColor:["#78ac4c","#ffbb00","#fb6542","#698bbe"],borderColor:"#fff",hoverBorderColor:"#fff",borderWidth:3,borderRadius:12},{data:[{x:"Profitmarge",value:e.profitMargin},{value:100-e.profitMargin}],backgroundColor:["#000","rgba( 0 0 0 / 0 )"],hoverBackgroundColor:["#000","rgba( 0 0 0 / 0 )"],borderColor:"#fff",hoverBorderColor:"#fff",borderWidth:3,borderRadius:12}]},options:{cutout:"40%",plugins:{legend:{position:"left",labels:{font:{size:15},boxWidth:24,generateLabels:()=>[{text:"Umsatz d. Versand",fillStyle:"#2f88ff"},{text:"Umsatz d. Abholung",fillStyle:"#1060d6"},{text:"Gewinn",fillStyle:"#78ac4c"},{text:"Versandkosten",fillStyle:"#ffbb00"},{text:"Gebühren",fillStyle:"#fb6542"},{text:"Rückerstattung",fillStyle:"#698bbe"},{text:"Profitmarge",fillStyle:"#000"}]}},tooltip:{filter:t=>!(2==t.datasetIndex&&1==t.dataIndex),callbacks:{label:t=>`${t.raw.x}: ${2==t.datasetIndex?formatPercent(t.raw.value/100):formatMoney(t.raw.value)}`}}}}})}function renderSankeyChart(t,e){const o=[],r={order:"#ccc",shipping:"#2f88ff",pickup:"#1060d6",profit:"#78ac4c",shippingCost:"#ffbb00",fees:"#fb6542",refund:"#698bbe"};for(const t of e){const e="#"+t.orderNumber,a=r[t.orderType],n={shipping:"Versand",pickup:"Abholung"}[t.orderType];o.push({from:e,to:n,flow:t.revenue,cFrom:r.order,cTo:a}),t.profit>0&&o.push({from:n,to:"Gewinn",flow:t.profit,cFrom:a,cTo:r.profit}),t.shipping>0&&o.push({from:n,to:"Versandkosten",flow:t.shipping,cFrom:a,cTo:r.shippingCost}),t.fees>0&&o.push({from:n,to:"Gebühren",flow:t.fees,cFrom:a,cTo:r.fees}),t.refund>0&&o.push({from:n,to:"Rückerstattung",flow:t.refund,cFrom:a,cTo:r.refund})}new Chart(t,{type:"sankey",data:{datasets:[{label:"Bestellungen",data:o,colorFrom:t=>t.raw.cFrom,colorTo:t=>t.raw.cTo,colorMode:"gradient",alpha:.6,borderWidth:0,nodeWidth:12,nodePadding:12,font:{weight:"bold"}}]},options:{plugins:{tooltip:{displayColors:!1,callbacks:{label:t=>`${t.raw.to}: ${formatMoney(t.raw.flow)}`}}}}})}document.addEventListener("DOMContentLoaded",(function(){Chart.defaults.responsive=!0,Chart.defaults.maintainAspectRatio=!1,Chart.defaults.offset=!1,Chart.defaults.layout.padding=0,Chart.defaults.font.family="SUSE, sans-serif",Chart.defaults.font.size=14,Chart.defaults.font.weight=400,Chart.defaults.color="#000",Chart.defaults.transitions={active:{animation:{duration:0}}},Chart.defaults.animations={x:{duration:0},y:{duration:150,easing:"easeOutBack"}},Chart.defaults.plugins.tooltip.padding={top:10,left:12,right:16,bottom:10},Chart.defaults.plugins.tooltip.animation={duration:150,easing:"easeOutBack"},Chart.defaults.plugins.tooltip.titleColor="#000",Chart.defaults.plugins.tooltip.bodyColor="#000",Chart.defaults.plugins.tooltip.backgroundColor="#fff",Chart.defaults.plugins.tooltip.borderColor="#d5d6d7",Chart.defaults.plugins.tooltip.borderWidth=1,Chart.defaults.plugins.tooltip.cornerRadius=5,Chart.defaults.plugins.tooltip.boxPadding=4,document.querySelectorAll(".chart-container").forEach((t=>{const e=JSON.parse(t.querySelector(".chartdata").textContent),o=t.getAttribute("chart-type"),r=t.querySelector(".chart");switch(r.classList.add(o),o){case"report":renderReportChart(r,e);break;case"margin":renderMarginChart(r,e);break;case"sankey":renderSankeyChart(r,e);break}}))}));